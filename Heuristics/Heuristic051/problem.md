実行時間制限: 2 sec / メモリ制限: 1024 MiB

## ストーリー

高橋市では現在、新たなごみ処理場を建設中である。 この処理場にはさまざまな種類のごみが運び込まれるため、処理を行う前に分別する必要がある。 分別は、例えば磁石によって鉄を含むものとそれ以外を分けるなど、いくつかの機器を使って行うことができる。 ただし、分別器は確率的にごみを二つの経路に振り分ける仕組みであり、ごみの種類を正確に識別することはできない。 そのため、例えば形状によって缶とそれ以外を分けた後に、磁石によってアルミ缶とスチール缶を分けるなど、複数の分別器を適切に組み合わせることが必要である。 複数の分別器をうまく組み合わせることにより、できるだけ正確にごみの分別を行ってほしい。

## 問題文

$N$ 種類のごみを分別して処理するためのごみ処理場を建設中である。 ごみ処理場は2次元平面上の $0 \le x \le 10^4$ 、$0 \le y \le 10^4$ からなる正方形領域として表現される。 この処理場にはさまざまな種類のごみがごみ搬入口から運び込まれる予定であり、処理装置と分別器を設置し、それらをベルトコンベアで結ぶことにより、できるだけ正確に分別を行った上で処理を行うことができるようにしたい。

### ごみ搬入口

処理場内に一つだけ存在し、座標は $(0,5000)$ である。 搬入口からは一本のベルトコンベアを伸ばし、処理装置または分別器へとごみを運ぶ。

### 処理装置

処理場内に各ごみの種類ごとに処理装置を $1$ 台ずつ設置する。 各ごみを正しい処理装置に運び込むことが目的である。

ごみ処理場内には処理装置を設置できるスペースがちょうど $N$ 箇所存在し、$i$ 番目の設置場所の座標は $(x_i^d, y_i^d)$ である。 どの設置場所にどの種類のごみの処理装置を設置するかは自由に選ぶことができる。

### 分別器

$K$ 種類のごみ自動分別器がある。 同じ分別器を複数設置しても構わない。

各分別器は運び込まれたごみを確率的に2つの経路のいずれかへと振り分け、出口1または出口2から運び出す。 このとき、どの経路に進むかはごみの種類ごとに定まった確率に従う。 $i$ 番目の自動分別器が種類 $j$ のごみを出口1から運び出す確率は $p_{i,j}$ であり、出口2から運び出す確率は $1-p_{i,j}$ である。

ごみ処理場内には分別器を設置するためのスペースが $M$ 箇所存在し、$i$ 番目の設置場所の座標は $(x_i^s, y_i^s)$ である。 各スペースには高々 $1$ 台の分別器を設置することができる。

### ベルトコンベア

ごみ搬入口ならびに各分別器の二つの出口からはベルトコンベアを伸ばし、処理装置もしくは他の分別器へとごみを運ぶ必要がある。 ベルトコンベアは始点と終点を結ぶ線分として敷設され、端点をひとつも共有しない二つのベルトコンベアは共有点を持ってはならない。 この条件では、分別器の二つの出口の行き先が同じであることも許容されている。

ごみ搬入口・処理装置・分別器を頂点、ベルトコンベアを辺とした有向グラフを考えたとき、有向グラフに閉路（自己閉路を含む）が存在してはならない。

### ヒント: 線分の交差判定について

線分 $p_1 p_2$ と $q_1 q_2$ が、共有点を持つかどうかは、以下の疑似コードにより判定できる。 なお、計算される値はすべて整数値のため、誤差は発生しない。

```python
def sign(x):
    return 1 if x > 0 else -1 if x < 0 else 0

def orientation(a, b, c):
    cross = (b.x - a.x) * (c.y - a.y) - (b.y - a.y) * (c.x - a.x)
    return sign(cross)

def segments_intersect(p1, p2, q1, q2):
    if (max(p1.x, p2.x) < min(q1.x, q2.x) or
        max(q1.x, q2.x) < min(p1.x, p2.x) or
        max(p1.y, p2.y) < min(q1.y, q2.y) or
        max(q1.y, q2.y) < min(p1.y, p2.y)):
        return False
    o1 = orientation(p1, p2, q1)
    o2 = orientation(p1, p2, q2)
    o3 = orientation(q1, q2, p1)
    o4 = orientation(q1, q2, p2)
    return (o1 * o2 <= 0) and (o3 * o4 <= 0)
```

### 得点

$i$ 種類目のごみが、それに対応する処理装置に最終的に運び込まれる確率を $q_i$ と定義する。 このとき、以下の絶対スコアが得られる：

$$
\text{round} \left( 10^9 \times \frac{1}{N} \sum_{i=0}^{N-1} (1-q_i) \right)
$$

## 入力

入力は以下の形式で標準入力から与えられる。

```
N M K
x_0^d y_0^d
...
x_{N-1}^d y_{N-1}^d
x_0^s y_0^s
...
x_{M-1}^s y_{M-1}^s
p_{0,0} ... p_{0,N-1}
...
p_{K-1,0} ... p_{K-1,N-1}
```

**制約** (8/1 19:30 修正)

-   ごみの種類数 $N$ は $5 \le N \le 20$ を満たす。
-   分別器設置場所の個数 $M$ は $10N \le M \le 50N$ を満たす。
-   分別器の個数 $K$ は $N \le K \le 4N$ を満たす。
-   $i$ 番目の処理装置設置場所の座標 $(x_i^d, y_i^d)$ は、$0 \le x_i^d, y_i^d \le 10^4$ を満たす整数である。
-   $i$ 番目の分別器設置場所の座標 $(x_i^s, y_i^s)$ は、$0 \le x_i^s, y_i^s \le 10^4$ を満たす整数である。
-   搬入口およびすべての設置場所の座標は互いに異なる。
-   $i$ 番目の分別器が種類 $j$ のごみを出口1から運び出す確率 $p_{i,j}$ は実数であり、$0 \le p_{i,j} \le 1$ を満たす。

## 出力

ベルトコンベアの行き先を、以下のように番号で表現する。

-   行き先が $i$ 番目の処理装置設置場所である場合は $i$
-   行き先が $i$ 番目の分別器設置場所である場合は $N+i$

$i$ 番目の処理装置設置場所に設置する処理装置の番号を $d_i$ ($0 \le d_i \le N-1$) とする。 ごみ搬入口から出るベルトコンベアの行き先を表す番号を $s$ ($0 \le s \le N+M-1$) とする。 このとき、以下の形式で標準出力に出力せよ。

```
d_0 ... d_{N-1}
s
```

続けて、$M$ 行を標準出力に出力せよ。 $i$ 行目は、$i$ 番目の分別器設置場所の状態に応じて以下のように出力する。

-   **分別器を設置しない場合：**
    ```
    -1
    ```
-   **$k$ 番目 ($0 \le k \le K-1$) の分別器を設置する場合：**
    出口1から出るベルトコンベアの行き先を表す番号が $v_1$ 、出口2から出るベルトコンベアの行き先を表す番号が $v_2$ である場合（$0 \le v_1, v_2 \le N+M-1$）：
    ```
    k v_1 v_2
    ```

**注記:** ベルトコンベアの行き先が分別器設置場所である場合、そこには分別器が設置されていなければならない。
